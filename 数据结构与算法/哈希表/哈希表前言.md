# å“ˆå¸Œè¡¨

å“ˆå¸Œçš„åŸºæœ¬åŸç†æ˜¯å°†ç»™å®šçš„é”®å€¼è½¬æ¢ä¸ºåç§»åœ°å€æ¥æ£€ç´¢è®°å½•ã€‚

é”®è½¬æ¢ä¸ºåœ°å€æ˜¯é€šè¿‡ä¸€ç§å…³ç³»ï¼ˆå…¬å¼ï¼‰æ¥å®Œæˆçš„ï¼Œè¿™å°±æ˜¯å“ˆå¸Œï¼ˆæ•£åˆ—ï¼‰å‡½æ•°ã€‚

è™½ç„¶å“ˆå¸Œè¡¨æ˜¯ä¸€ç§æœ‰æ•ˆçš„æœç´¢æŠ€æœ¯ï¼Œä½†æ˜¯å®ƒè¿˜æœ‰äº›ç¼ºç‚¹ã€‚ä¸¤ä¸ªä¸åŒçš„å…³é”®å­—ï¼Œç”±äºå“ˆå¸Œå‡½æ•°å€¼ç›¸åŒï¼Œå› è€Œè¢«æ˜ å°„åˆ°åŒä¸€è¡¨ä½ç½®ä¸Šã€‚è¯¥ç°è±¡ç§°ä¸ºå†²çªã€‚å‘ç”Ÿå†²çªçš„ä¸¤ä¸ªå…³é”®å­—ç§°ä¸ºè¯¥å“ˆå¸Œå‡½æ•°çš„åŒä¹‰è¯ã€‚

![img](http://ruoruochen-img-bed.oss-cn-beijing.aliyuncs.com/img/B2Ss9kyndzZ1LCA.png)

> å¦‚ä½•è®¾è®¡å“ˆå¸Œå‡½æ•°ä»¥åŠå¦‚ä½•é¿å…å†²çªå°±æ˜¯å“ˆå¸Œè¡¨çš„å¸¸è§é—®é¢˜ã€‚ å¥½çš„å“ˆå¸Œå‡½æ•°çš„é€‰æ‹©æœ‰ä¸¤æ¡æ ‡å‡†ï¼š

- 1.ç®€å•å¹¶ä¸”èƒ½å¤Ÿå¿«é€Ÿè®¡ç®—
- 2.èƒ½å¤Ÿåœ¨å€ç©ºé—´ä¸­è·å–é”®çš„å‡åŒ€äººåˆ†å¸ƒ

ä¾‹å¦‚ä¸‹é¢çš„é¢˜ç›®ï¼š

[leetcode 380 å¸¸æ•°æ—¶é—´æ’å…¥ã€åˆ é™¤å’Œè·å–éšæœºå…ƒç´ ](https://leetcode-cn.com/problems/insert-delete-getrandom-o1/)

## å¸¸æ•°æ—¶é—´æ’å…¥ã€åˆ é™¤å’Œè·å–éšæœºå…ƒç´ 

### é¢˜ç›®

è®¾è®¡ä¸€ä¸ªæ”¯æŒåœ¨å¹³å‡ æ—¶é—´å¤æ‚åº¦ O(1) ä¸‹ï¼Œæ‰§è¡Œä»¥ä¸‹æ“ä½œçš„æ•°æ®ç»“æ„ã€‚

1. insert(val)ï¼šå½“å…ƒç´  val ä¸å­˜åœ¨æ—¶ï¼Œå‘é›†åˆä¸­æ’å…¥è¯¥é¡¹ã€‚
2. remove(val)ï¼šå…ƒç´  val å­˜åœ¨æ—¶ï¼Œä»é›†åˆä¸­ç§»é™¤è¯¥é¡¹ã€‚
3. getRandomï¼šéšæœºè¿”å›ç°æœ‰é›†åˆä¸­çš„ä¸€é¡¹ã€‚æ¯ä¸ªå…ƒç´ åº”è¯¥æœ‰ç›¸åŒçš„æ¦‚ç‡è¢«è¿”å›ã€‚

**ç¤ºä¾‹ :**

```js
// åˆå§‹åŒ–ä¸€ä¸ªç©ºçš„é›†åˆã€‚
RandomizedSet randomSet = new RandomizedSet();

// å‘é›†åˆä¸­æ’å…¥ 1 ã€‚è¿”å› true è¡¨ç¤º 1 è¢«æˆåŠŸåœ°æ’å…¥ã€‚
randomSet.insert(1);

// è¿”å› false ï¼Œè¡¨ç¤ºé›†åˆä¸­ä¸å­˜åœ¨ 2 ã€‚
randomSet.remove(2);

// å‘é›†åˆä¸­æ’å…¥ 2 ã€‚è¿”å› true ã€‚é›†åˆç°åœ¨åŒ…å« [1,2] ã€‚
randomSet.insert(2);

// getRandom åº”éšæœºè¿”å› 1 æˆ– 2 ã€‚
randomSet.getRandom();

// ä»é›†åˆä¸­ç§»é™¤ 1 ï¼Œè¿”å› true ã€‚é›†åˆç°åœ¨åŒ…å« [2] ã€‚
randomSet.remove(1);

// 2 å·²åœ¨é›†åˆä¸­ï¼Œæ‰€ä»¥è¿”å› false ã€‚
randomSet.insert(2);

// ç”±äº 2 æ˜¯é›†åˆä¸­å”¯ä¸€çš„æ•°å­—ï¼ŒgetRandom æ€»æ˜¯è¿”å› 2 ã€‚
randomSet.getRandom();
```

### ä»£ç 

#### è§£æ³•ä¸€ï¼šæ•°ç»„+å¯¹è±¡

ä½¿ç”¨ä¸€ä¸ªæ•°ç»„è®°å½•å€¼ï¼Œä½¿ç”¨ä¸€ä¸ªMapå­˜å‚¨é”®å€¼å¯¹ï¼Œé”®ä¸ºå­˜å‚¨çš„valï¼Œå€¼ä¸ºæ”¹valueçš„ä¸‹æ ‡ã€‚

```js
/**
 * Initialize your data structure here.
 */
var RandomizedSet = function () {
  this.set = [];
  //è¡¨ç¤ºæ•°ç»„ä¸­çš„å¯¹åº”çš„å€¼çš„ä¸‹æ ‡æ˜¯å¤šå°‘
  //ç”¨å“ˆå¸Œè¡¨çš„é”®(key)å­˜å‚¨val ç”¨å€¼(value)å­˜å‚¨è¿™ä¸ªå€¼åœ¨æ•°ç»„ä¸­çš„ä¸‹æ ‡index
  //ç„¶ååˆ é™¤çš„æ—¶å€™å°±å¯ä»¥æ ¹æ®valæ‰¾åˆ°æ•°ç»„é‡Œé¢çš„ä¸‹æ ‡ ç„¶ååœ¨æ•°ç»„ä¸­è¿›è¡Œåˆ é™¤
  //æ¯”å¦‚è¯´å½“æˆ‘æƒ³è¦æ‰¾æ•°ç»„é‡Œé¢çš„10 å°±å¯ä»¥é€šè¿‡setMap[10]æ¥æ‰¾åˆ°æ•°ç»„ä¸­å¯¹åº”çš„ä¸‹æ ‡ç„¶ååˆ é™¤ ä¸éœ€è¦éå†
  this.setMap = {};
};

/**
 * Inserts a value to the set. Returns true if the set did not already contain the specified element. 
 * @param {number} val
 * @return {boolean}
 */
RandomizedSet.prototype.insert = function (val) {
  //å­˜åœ¨è¯¥å€¼ï¼Œç›´æ¥return false
  if (typeof (this.setMap[val]) !== "undefined") return false;
  //åœ¨è¡¨ä¸­è®°å½•æ’å…¥å€¼åœ¨æ•°ç»„ä¸­çš„ä¸‹æ ‡
  this.setMap[val] = this.set.length;
  this.set.push(val);
  return true;
};

/**
 * Removes a value from the set. Returns true if the set contained the specified element. 
 * @param {number} val
 * @return {boolean}
 */
RandomizedSet.prototype.remove = function (val) {
  //å¦‚æœä¸å­˜åœ¨ï¼Œè¿”å›false
  if (typeof (this.setMap[val]) === "undefined") return false;
  //æ‰¾åˆ°æœ€åä¸€ä¸ªæ•°çš„ä¸‹æ ‡å’Œå€¼
  let lastIndex = this.set.length - 1;
  let lastNum = this.set[lastIndex];
  //åˆ é™¤å€¼çš„ä¸‹æ ‡
  let deleteIndex = this.setMap[val];
  //æœ€åä¸€ä¸ªæ•°ä»£æ›¿åˆ é™¤å€¼
  this.set[deleteIndex] = lastNum;
  //åœ¨è¡¨ä¸­ä¿®æ”¹lastNumçš„ä½ç½®
  this.setMap[lastNum] = deleteIndex;
  //åˆ é™¤æœ€åä¸€ä¸ªå€¼å’Œè¡¨ä¸­çš„å€¼
  this.set.pop();
  delete this.setMap[val];
  return true;
};

/**
 * Get a random element from the set.
 * @return {number}
 */
RandomizedSet.prototype.getRandom = function () {
  let size = this.set.length;
  let random = Math.floor(Math.random() * size);
  return this.set[random];
};

/**
 * Your RandomizedSet object will be instantiated and called as such:
 * var obj = new RandomizedSet()
 * var param_1 = obj.insert(val)
 * var param_2 = obj.remove(val)
 * var param_3 = obj.getRandom()
 */
```

![image-20210202175056653](http://ruoruochen-img-bed.oss-cn-beijing.aliyuncs.com/img/image-20210202175056653.png)

#### è§£æ³•äºŒï¼šMap+æ•°ç»„

```js
/**
 * Initialize your data structure here.
 */
var RandomizedSet = function () {
  this.set = [];
  this.map = new Map();
};

/**
 * Inserts a value to the set. Returns true if the set did not already contain the specified element. 
 * @param {number} val
 * @return {boolean}
 */
RandomizedSet.prototype.insert = function (val) {
  //å­˜åœ¨è¯¥å€¼ï¼Œç›´æ¥return false
  if (this.map.has(val)) return false;
  //åœ¨è¡¨ä¸­è®°å½•æ’å…¥å€¼åœ¨æ•°ç»„ä¸­çš„ä¸‹æ ‡
  this.map.set(val, this.set.length);
  this.set.push(val);
  return true;
};

/**
 * Removes a value from the set. Returns true if the set contained the specified element. 
 * @param {number} val
 * @return {boolean}
 */
RandomizedSet.prototype.remove = function (val) {
  //å¦‚æœä¸å­˜åœ¨ï¼Œè¿”å›false
  if (!this.map.has(val)) return false;
  //è·å–åˆ é™¤å€¼çš„ä¸‹æ ‡
  let deleteIndex = this.map.get(val);
  //å¦‚æœä¸ºæœ€åä¸€ä¸ªï¼Œç›´æ¥åˆ é™¤
  if (deleteIndex === this.set.length - 1) {
    this.set.pop();
    this.map.delete(val);
  } else {
    // è·å–æœ€åä¸€ä¸ªçš„å€¼å¹¶åˆ é™¤
    const lastNum = this.set.pop();
    //å°†æœ€åä¸€ä¸ªçš„å€¼è¦†ç›–åœ¨åˆ é™¤çš„åæ ‡ä¸Š
    this.set[deleteIndex] = lastNum;
    this.map.set(lastNum, deleteIndex);
    //åˆ é™¤æ—§çš„Map
    this.map.delete(val);
  }
  return true;
};

/**
 * Get a random element from the set.
 * @return {number}
 */
RandomizedSet.prototype.getRandom = function () {
  let size = this.set.length;
  let random = Math.floor(Math.random() * size);
  return this.set[random];
};

/**
 * Your RandomizedSet object will be instantiated and called as such:
 * var obj = new RandomizedSet()
 * var param_1 = obj.insert(val)
 * var param_2 = obj.remove(val)
 * var param_3 = obj.getRandom()
 */
```

![image-20210202180141097](http://ruoruochen-img-bed.oss-cn-beijing.aliyuncs.com/img/image-20210202180141097.png)

#### è§£æ³•ä¸‰ï¼šSet

æ•°æ®ç»“æ„ Setã€‚å®ƒç±»ä¼¼äºæ•°ç»„ï¼Œä½†æ˜¯æˆå‘˜çš„å€¼éƒ½æ˜¯å”¯ä¸€çš„ï¼Œæ²¡æœ‰é‡å¤çš„å€¼ã€‚

```
 ...å°†ä¸€ä¸ªæ•°ç»„è½¬ä¸ºç”¨é€—å·åˆ†éš”çš„å‚æ•°åºåˆ—ï¼Œå³Setè½¬æ•°ç»„
[...set]
```

```js
var RandomizedSet = function() {
    this.set = new Set()
}

RandomizedSet.prototype.insert = function(val) {
    if (this.set.has(val)) {
        return false
    }
    this.set.add(val)
    return true
}

RandomizedSet.prototype.remove = function(val) {
    if (!this.set.has(val)) {
        return false
    }
    this.set.delete(val)
    return true
}

RandomizedSet.prototype.getRandom = function() {
    const random = parseInt(Math.random()*(this.set.size))
    return [...this.set][random]
}
```

![image-20210202180510580](http://ruoruochen-img-bed.oss-cn-beijing.aliyuncs.com/img/image-20210202180510580.png)

> å½“ç”¨åˆ°å“ˆå¸Œè¡¨æ—¶æˆ‘ä»¬é€šå¸¸æ˜¯è¦å¼€è¾Ÿä¸€ä¸ªé¢å¤–ç©ºé—´æ¥è®°å½•ä¸€äº›è®¡ç®—è¿‡çš„å€¼ï¼ŒåŒæ—¶æˆ‘ä»¬åˆè¦åœ¨ä¸‹ä¸€æ¬¡è®¡ç®—çš„è¿‡ç¨‹ä¸­å¿«é€Ÿæ£€ç´¢åˆ°å®ƒä»¬ï¼Œä¾‹å¦‚ä¸Šé¢æåˆ°çš„ä¸¤æ•°ä¹‹å’Œã€ä¸‰æ•°ä¹‹å’Œç­‰éƒ½åˆ©ç”¨äº†è¿™ç§æ€æƒ³ã€‚

[leetcode 1 ä¸¤æ•°ä¹‹å’Œé¢˜è§£](https://blog.csdn.net/weixin_43786756/article/details/112665583?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522161226060216780299027308%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fblog.%2522%257D&request_id=161226060216780299027308&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_v1~rank_blog_v1-1-112665583.pc_v1_rank_blog_v1&utm_term=%E4%B8%A4%E6%95%B0&spm=1018.2226.3001.4450)

[leetcode 15 ä¸‰æ•°ä¹‹å’Œé¢˜è§£](https://blog.csdn.net/weixin_43786756/article/details/112665609?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522161226064216780264016545%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fblog.%2522%257D&request_id=161226064216780264016545&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_v1~rank_blog_v1-1-112665609.pc_v1_rank_blog_v1&utm_term=ä¸‰æ•°&spm=1018.2226.3001.4450)

[leetcode 771 å®çŸ³ä¸çŸ³å¤´é¢˜è§£](https://blog.csdn.net/weixin_43786756/article/details/113770047)

# æ›´å¤šèµ„æ–™

æ•´ç†ä¸æ˜“ï¼Œè‹¥å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·ç»™ä¸ªã€Œå…³æ³¨+ç‚¹èµã€ï¼Œæ‚¨çš„æ”¯æŒæ˜¯æˆ‘æ›´æ–°çš„åŠ¨åŠ› ğŸ‘‡

ğŸ“–æ•°æ®ç»“æ„ä¸“æ ï¼š[å‰‘æŒ‡ Offer é¢˜è§£ + JS ä»£ç ](https://blog.csdn.net/weixin_43786756/category_10716516.html) 
ğŸ±Githubç¬”è®° ï¼š[ruoruochen GitHub](https://github.com/ruoruochen/front-end-note)

